<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotels</title>
    <link rel="stylesheet" href="style.css"> <!-- Optional CSS -->
</head>
<body>
    <h1>Hotels List</h1>
    <table id="hotels-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Location</th>
                <th>Rating</th>
                <th>Description</th>
                <th>Price per Night</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="hotels-list">
            <!-- Data will be populated here -->
        </tbody>
    </table>

    <script>
        // Fetch hotels data from the server
        fetch('/api/hotels')
            .then(response => response.json())
            .then(data => {
                const hotelsList = document.getElementById('hotels-list');
                hotelsList.innerHTML = data.map(hotel => `
                    <tr>
                        <td>${hotel.name}</td>
                        <td>${hotel.location}</td>
                        <td>${hotel.rating}</td>
                        <td>${hotel.description}</td>
                        <td>$${hotel.price_per_night}</td>
                        <td><button onclick="bookHotel(${hotel.hotel_id})">Book</button></td>
                    </tr>
                `).join('');
            })
            .catch(error => {
                console.error('Error fetching hotels data:', error);
            });

        // Function to book a hotel
        function bookHotel(hotel_id) {
            const user_id = 1; // Replace with actual user ID, or get from user session
            const check_in_date = prompt('Enter check-in date (YYYY-MM-DD):');
            const check_out_date = prompt('Enter check-out date (YYYY-MM-DD):');
            const total_amount = prompt('Enter total amount:');

            fetch('/api/book', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ user_id, hotel_id, check_in_date, check_out_date, total_amount }),
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
            })
            .catch(error => {
                console.error('Error booking hotel:', error);
                alert('Failed to book the hotel');
            });
        }
    </script>
</body>
</html>
